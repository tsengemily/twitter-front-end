(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d5d8ad46"],{1511:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"page-container"},[e.isLoading?r("Spinner"):[r("div",{staticClass:"row"},[r("div",{staticClass:"left"},[r("Navbar",{attrs:{isSetting:e.isSetting,MainPage:e.MainPage,PersonalInfo:e.PersonalInfo,ChatRoom:e.ChatRoom}})],1),r("div",{staticClass:"main"},[r("UserHeader",{attrs:{"user-id":e.user.id,"user-name":e.user.name,"user-tweets-count":e.user.tweetCount}}),r("UserProfileCard",{attrs:{"initial-user":e.user},on:{"after-add-follow-profile":e.afterAddFollowProfile,"after-delete-follow-profile":e.afterDeleteFollowProfile}}),r("div",{staticClass:"d-flex"},[r("router-link",{staticClass:"user-following",attrs:{to:{name:"user-following",params:{id:e.user.id}}}},[r("strong",[e._v(e._s(e.user.followingCount)+"個")]),e._v("跟隨中 ")]),r("router-link",{staticClass:"user-follower",attrs:{to:{name:"user-follower",params:{id:e.user.id}}}},[r("strong",[e._v(e._s(e.user.followerCount)+"位")]),e._v("跟隨者 ")])],1),r("div",{staticClass:"nav"},[r("router-link",{staticClass:"nav-item active",attrs:{to:{name:"user",params:{id:e.user.id}}}},[e._v(" 推文 ")]),r("router-link",{staticClass:"nav-item",attrs:{to:{name:"user-with-replies",params:{id:e.user.id}}}},[e._v(" 推文與回覆 ")]),r("router-link",{staticClass:"nav-item",attrs:{to:{name:"user-likes",params:{id:e.user.id}}}},[e._v(" 喜歡的內容 ")])],1),r("PostCard",{attrs:{initialTweets:e.tweets}}),e.tweets.length<1?r("div",{staticClass:"no-data"},[e._v("沒有推文")]):e._e()],1),r("div",{staticClass:"right"},[r("div",{staticClass:"top-users-container"},[r("h1",{staticClass:"top-users-title"},[e._v("跟隨誰")]),e._l(e.topUsers,(function(t){return r("Top10User",{key:t.id,attrs:{"initial-top-user":t},on:{"after-add-follow":e.afterAddFollow,"after-delete-follow":e.afterDeleteFollow}})})),r("div",{staticClass:"top-users-more"},[e._v(" 顯示更多 ")])],2)])])]],2)},i=[],a=r("1da1"),n=r("5530"),o=(r("96cf"),r("b0c0"),r("d178")),c=r("3e69"),u=r("7950"),l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"card-container"},e._l(e.tweets,(function(t){return s("div",{key:t.id,staticClass:"tweet d-flex"},[s("router-link",{staticClass:"post-link",attrs:{to:{name:"ReplyList",params:{id:t.id}}}}),s("router-link",{staticClass:"user-link",attrs:{to:{name:"user",params:{id:t.UserId}}}},[s("img",{staticClass:"user-avatar",attrs:{src:t.User.avatar}})]),s("div",[s("div",{staticClass:"d-flex"},[s("h1",{staticClass:"user-name"},[e._v(" "+e._s(t.User.name)+" ")]),s("span",{staticClass:"user-account ml-2"},[e._v(" @"+e._s(t.User.account)+" ")]),e._v(" ． "),s("span",{staticClass:"post-time"},[e._v(" "+e._s(e._f("fromNow")(t.createdAt))+" ")])]),s("p",{staticClass:"post-txt"},[e._v(" "+e._s(t.description)+" ")]),s("div",{staticClass:"d-flex mt-2"},[s("div",{staticClass:"comment"},[s("img",{attrs:{src:r("6ae1")}}),e._v(" "+e._s(t.replyCount)+" ")]),s("div",{staticClass:"like"},[t.isLikedByMe?[s("img",{attrs:{src:r("e16e"),disabled:e.isProcessing},on:{click:function(r){return e.deleteLike(t.id)}}})]:[s("img",{attrs:{src:r("8e44"),disabled:e.isProcessing},on:{click:function(r){return e.addLike(t.id)}}})],e._v(" "+e._s(t.likeCount)+" ")],2)])])],1)})),0)},d=[],f=(r("d81d"),r("c1df")),w=r.n(f),h=r("1602"),v=r("2fa3"),m={name:"PostCard",props:{initialTweets:{type:Array,require:!0}},data:function(){return{tweets:this.initialTweets,isProcessing:!1}},watch:{initialTweets:function(e){this.tweets=e}},methods:{addLike:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var s,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isProcessing=!0,r.next=4,h["a"].addLike({tweetId:e});case 4:if(s=r.sent,i=s.data,"success"===i.status){r.next=8;break}throw new Error(i.message);case 8:t.tweets=t.tweets.map((function(t){if(t.id===e){var r=t.likeCount+1;return Object(n["a"])(Object(n["a"])({},t),{},{isLikedByMe:!0,likeCount:r})}return t})),console.log("成功"),r.next=17;break;case 12:r.prev=12,r.t0=r["catch"](0),v["a"].fire({icon:"error",title:"無法加入喜歡，請稍後再試"}),console.log(r.t0),t.isProcessing=!1;case 17:case"end":return r.stop()}}),r,null,[[0,12]])})))()},deleteLike:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var s,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isProcessing=!0,r.next=4,h["a"].deleteLike({tweetId:e});case 4:if(s=r.sent,i=s.data,"success"===i.status){r.next=8;break}throw new Error(i.message);case 8:t.tweets=t.tweets.map((function(t){if(t.id===e){var r=t.likeCount-1;return Object(n["a"])(Object(n["a"])({},t),{},{isLikedByMe:!1,likeCount:r})}return t})),console.log("成功"),r.next=17;break;case 12:r.prev=12,r.t0=r["catch"](0),v["a"].fire({icon:"error",title:"無法移除喜歡，請稍後再試"}),console.log(r.t0),t.isProcessing=!1;case 17:case"end":return r.stop()}}),r,null,[[0,12]])})))()}},filters:{fromNow:function(e){return e?w()(e).fromNow():"-"}}},p=m,g=(r("647c"),r("2877")),C=Object(g["a"])(p,l,d,!1,null,"6ee0ce73",null),k=C.exports,_=r("1ed3"),b=r("2375"),U=r("2f62"),P={name:"User",components:{Navbar:o["a"],UserHeader:c["a"],UserProfileCard:u["a"],PostCard:k,Top10User:_["a"],Spinner:b["a"]},data:function(){return{MainPage:!1,isSetting:!1,PersonalInfo:!1,ChatRoom:!1,user:{id:-1,name:"",email:"",account:"",cover:"",avatar:"",introduction:"",isFollowed:!1,followerCount:0,followingCount:0,tweetCount:0},tweets:[],topUsers:[],isLoading:!0}},computed:Object(n["a"])({},Object(U["b"])(["currentUser"])),created:function(){var e=this.$route.params.id;this.fetchTopUsers(),this.fetchUser({userId:e}),this.fetchTweets({userId:e});var t=this.$router.history.current.name;"user"===t&&e===this.currentUser.id&&(this.MainPage=!1,this.isSetting=!1,this.PersonalInfo=!0,this.ChatRoom=!1)},methods:{fetchUser:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var s,i,a,o,c,u,l,d,f,w,m,p,g,C;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s=e.userId,console.log("userId",s),r.prev=2,t.isLoading=!0,r.next=6,h["a"].get({userId:s});case 6:i=r.sent,a=i.data,console.log({data:a}),o=a.id,c=a.name,u=a.email,l=a.account,d=a.cover,f=a.avatar,w=a.introduction,m=a.isFollowed,p=a.followerCount,g=a.followingCount,C=a.tweetCount,t.user=Object(n["a"])(Object(n["a"])({},t.user),{},{id:o,name:c,email:u,account:l,cover:d,avatar:f,introduction:w,isFollowed:m,followerCount:p,followingCount:g,tweetCount:C}),t.isLoading=!1,r.next=19;break;case 14:r.prev=14,r.t0=r["catch"](2),t.isLoading=!1,console.log("error",r.t0),v["a"].fire({icon:"error",title:"載入資料失敗，請稍後再試"});case 19:case"end":return r.stop()}}),r,null,[[2,14]])})))()},fetchTweets:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var s,i,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s=e.userId,r.prev=1,t.isLoading=!0,r.next=5,h["a"].getTweets({userId:s});case 5:i=r.sent,a=i.data,t.tweets=a,t.isLoading=!1,r.next=16;break;case 11:r.prev=11,r.t0=r["catch"](1),t.isLoading=!1,console.log("error",r.t0),v["a"].fire({icon:"error",title:"載入資料失敗，請稍後再試"});case 16:case"end":return r.stop()}}),r,null,[[1,11]])})))()},fetchTopUsers:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,t.next=4,h["a"].getUsersTop();case 4:r=t.sent,s=r.data,e.topUsers=s,e.isLoading=!1,t.next=15;break;case 10:t.prev=10,t.t0=t["catch"](0),e.isLoading=!1,console.log("error",t.t0),v["a"].fire({icon:"error",title:"載入資料失敗，請稍後再試"});case 15:case"end":return t.stop()}}),t,null,[[0,10]])})))()},afterAddFollow:function(e){var t=e.userId;t!==this.user.id&&t!==this.currentUser.id&&this.user.id!==this.currentUser.id||(this.user.id===t&&(this.user.followerCount+=1),this.currentUser.id!==t&&this.user.id!==t&&(this.user.followingCount+=1))},afterDeleteFollow:function(e){var t=e.userId;t!==this.user.id&&t!==this.currentUser.id&&this.user.id!==this.currentUser.id||(this.user.id===t&&(this.user.followerCount-=1),this.currentUser.id!==t&&this.user.id!==t&&(this.user.followingCount-=1))},afterAddFollowProfile:function(){this.user.followerCount+=1},afterDeleteFollowProfile:function(){this.user.followerCount-=1}},beforeRouteUpdate:function(e,t,r){var s=e.params.id;this.fetchTopUsers(),this.fetchUser({userId:s}),this.fetchTweets({userId:s});var i=this.$router.history.current.name;"user-follower"===i&&s===this.currentUser.id&&(this.MainPage=!1,this.isSetting=!1,this.PersonalInfo=!0,this.ChatRoom=!1),r()}},x=P,L=(r("da6c"),Object(g["a"])(x,s,i,!1,null,"7b6dea8e",null));t["default"]=L.exports},4538:function(e,t,r){},"647c":function(e,t,r){"use strict";r("4538")},"849f":function(e,t,r){},da6c:function(e,t,r){"use strict";r("849f")}}]);
//# sourceMappingURL=chunk-d5d8ad46.e6091f66.js.map