(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b6f1e77"],{"035c":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page-container"},[e.isLoading?s("Spinner"):[s("div",{staticClass:"row"},[s("div",{staticClass:"left"},[s("Navbar",{attrs:{isSetting:e.isSetting,MainPage:e.MainPage,PersonalInfo:e.PersonalInfo,ChatRoom:e.ChatRoom}})],1),s("div",{staticClass:"main"},[s("UserHeader",{attrs:{"user-id":e.user.id,"user-name":e.user.name,"user-tweets-count":e.user.tweetCount}}),s("UserProfileCard",{attrs:{"initial-user":e.user},on:{"after-add-follow-profile":e.afterAddFollowProfile,"after-delete-follow-profile":e.afterDeleteFollowProfile}}),s("div",{staticClass:"d-flex"},[s("router-link",{staticClass:"user-following",attrs:{to:{name:"user-following",params:{id:e.user.id}}}},[s("strong",[e._v(e._s(e.user.followingCount)+"個")]),e._v("跟隨中 ")]),s("router-link",{staticClass:"user-follower",attrs:{to:{name:"user-follower",params:{id:e.user.id}}}},[s("strong",[e._v(e._s(e.user.followerCount)+"位")]),e._v("跟隨者 ")])],1),s("div",{staticClass:"nav"},[s("router-link",{staticClass:"nav-item",attrs:{to:{name:"user",params:{id:e.user.id}}}},[e._v(" 推文 ")]),s("router-link",{staticClass:"nav-item",attrs:{to:{name:"user-with-replies",params:{id:e.user.id}}}},[e._v(" 推文與回覆 ")]),s("router-link",{staticClass:"nav-item active",attrs:{to:{name:"user-likes",params:{id:e.user.id}}}},[e._v(" 喜歡的內容 ")])],1),s("LikeCard",{attrs:{"initial-tweets-likes":e.tweetsLikes}}),e.tweetsLikes.length<1?s("div",{staticClass:"no-data"},[e._v(" 沒有喜歡的內容 ")]):e._e()],1),s("div",{staticClass:"right"},[s("div",{staticClass:"top-users-container"},[s("h1",{staticClass:"top-users-title"},[e._v("跟隨誰")]),e._l(e.topUsers,(function(t){return s("Top10User",{key:t.id,attrs:{"initial-top-user":t},on:{"after-add-follow":e.afterAddFollow,"after-delete-follow":e.afterDeleteFollow}})})),s("div",{staticClass:"top-users-more"},[e._v("顯示更多")])],2)])])]],2)},i=[],a=s("1da1"),n=s("5530"),o=(s("96cf"),s("b0c0"),s("d178")),l=s("3e69"),c=s("7950"),u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"card-container"},e._l(e.tweetsLikes,(function(t){return r("div",{key:t.id,staticClass:"tweet d-flex"},[r("router-link",{staticClass:"post-link",attrs:{to:{name:"ReplyList",params:{id:t.TweetId}}}}),r("router-link",{staticClass:"user-link",attrs:{to:{name:"user",params:{id:t.Tweet.User.id}}}},[r("img",{staticClass:"user-avatar",attrs:{src:t.Tweet.User.avatar}})]),r("div",[r("div",{staticClass:"d-flex"},[r("h1",{staticClass:"user-name"},[e._v(" "+e._s(t.Tweet.User.name)+" ")]),r("span",{staticClass:"user-account ml-2"},[e._v(" @"+e._s(t.Tweet.User.account)+" ")]),e._v(" ． "),r("span",{staticClass:"post-time"},[e._v(" "+e._s(e._f("fromNow")(t.createdAt))+" ")])]),r("p",{staticClass:"post-txt"},[e._v(" "+e._s(t.Tweet.description)+" ")]),r("div",{staticClass:"d-flex mt-2"},[r("div",{staticClass:"comment"},[r("img",{attrs:{src:s("6ae1")}}),e._v(" "+e._s(t.Tweet.replyCount)+" ")]),r("div",{staticClass:"like"},[t.Tweet.isLikedByMe?[r("img",{attrs:{src:s("e16e")},on:{click:function(s){return e.deleteLike(t.Tweet.id)}}})]:[r("img",{attrs:{src:s("8e44")},on:{click:function(s){return e.addLike(t.Tweet.id)}}})],e._v(" "+e._s(t.Tweet.likeCount)+" ")],2)])])],1)})),0)},d=[],f=(s("d81d"),s("c1df")),w=s.n(f),h=s("1602"),v=s("2fa3"),m={name:"LikeCard",props:{initialTweetsLikes:{type:Array,require:!0}},watch:{initialTweetsLikes:function(e){this.tweetsLikes=e}},data:function(){return{tweetsLikes:this.initialTweetsLikes}},methods:{addLike:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function s(){var r,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,h["a"].addLike({tweetId:e});case 3:if(r=s.sent,i=r.data,"success"===i.status){s.next=7;break}throw new Error(i.message);case 7:console.log(e),t.tweetsLikes=t.tweetsLikes.map((function(t){if(t.Tweet.id===e){var s=t.Tweet.likeCount+1;return Object(n["a"])(Object(n["a"])({},t),{},{Tweet:Object(n["a"])(Object(n["a"])({},t.Tweet),{},{isLikedByMe:!0,likeCount:s})})}return t})),console.log("加入喜歡成功"),s.next=16;break;case 12:s.prev=12,s.t0=s["catch"](0),v["a"].fire({icon:"error",title:"無法加入喜歡，請稍後再試"}),console.log(s.t0);case 16:case"end":return s.stop()}}),s,null,[[0,12]])})))()},deleteLike:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function s(){var r,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,h["a"].deleteLike({tweetId:e});case 3:if(r=s.sent,i=r.data,"success"===i.status){s.next=7;break}throw new Error(i.message);case 7:console.log(e),t.tweetsLikes=t.tweetsLikes.map((function(t){if(t.Tweet.id===e){var s=t.Tweet.likeCount-1;return Object(n["a"])(Object(n["a"])({},t),{},{Tweet:Object(n["a"])(Object(n["a"])({},t.Tweet),{},{isLikedByMe:!1,likeCount:s})})}return t})),console.log("移除喜歡成功"),s.next=16;break;case 12:s.prev=12,s.t0=s["catch"](0),v["a"].fire({icon:"error",title:"無法移除喜歡，請稍後再試"}),console.log(s.t0);case 16:case"end":return s.stop()}}),s,null,[[0,12]])})))()}},filters:{fromNow:function(e){return e?w()(e).fromNow():"-"}}},p=m,g=(s("60c3"),s("2877")),k=Object(g["a"])(p,u,d,!1,null,"155a73cc",null),C=k.exports,L=s("1ed3"),b=s("2375"),_=s("2f62"),T={name:"User",components:{Navbar:o["a"],UserHeader:l["a"],UserProfileCard:c["a"],LikeCard:C,Top10User:L["a"],Spinner:b["a"]},data:function(){return{user:{id:-1,name:"",email:"",account:"",cover:"",avatar:"",introduction:"",isFollowed:!1,followerCount:0,followingCount:0,tweetCount:0},tweetsLikes:[],topUsers:[],isLoading:!0,MainPage:!1,isSetting:!1,PersonalInfo:!1,ChatRoom:!1}},computed:Object(n["a"])({},Object(_["b"])(["currentUser"])),created:function(){var e=this.$route.params.id;this.fetchTopUsers(),this.fetchUser({userId:e}),this.fetchTweetsLike({userId:e});var t=this.$router.history.current.name;console.log(t),"user-likes"===t&&e===this.currentUser.id&&(this.MainPage=!1,this.isSetting=!1,this.PersonalInfo=!0,this.ChatRoom=!1)},methods:{fetchUser:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function s(){var r,i,a,o,l,c,u,d,f,w,m,p,g,k;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return r=e.userId,s.prev=1,t.isLoading=!0,s.next=5,h["a"].get({userId:r});case 5:i=s.sent,a=i.data,o=a.id,l=a.name,c=a.email,u=a.account,d=a.cover,f=a.avatar,w=a.introduction,m=a.isFollowed,p=a.followerCount,g=a.followingCount,k=a.tweetCount,t.user=Object(n["a"])(Object(n["a"])({},t.user),{},{id:o,name:l,email:c,account:u,cover:d,avatar:f,introduction:w,isFollowed:m,followerCount:p,followingCount:g,tweetCount:k}),t.isLoading=!1,s.next=17;break;case 12:s.prev=12,s.t0=s["catch"](1),t.isLoading=!1,console.log("error",s.t0),v["a"].fire({icon:"error",title:"載入資料失敗，請稍後再試"});case 17:case"end":return s.stop()}}),s,null,[[1,12]])})))()},fetchTweetsLike:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function s(){var r,i,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return r=e.userId,s.prev=1,t.isLoading=!0,s.next=5,h["a"].getLikes({userId:r});case 5:i=s.sent,a=i.data,t.tweetsLikes=a,t.isLoading=!1,s.next=16;break;case 11:s.prev=11,s.t0=s["catch"](1),t.isLoading=!1,console.log("error",s.t0),v["a"].fire({icon:"error",title:"載入資料失敗，請稍後再試"});case 16:case"end":return s.stop()}}),s,null,[[1,11]])})))()},fetchTopUsers:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,t.next=4,h["a"].getUsersTop();case 4:s=t.sent,r=s.data,console.log({data:r}),e.topUsers=r,e.isLoading=!1,t.next=16;break;case 11:t.prev=11,t.t0=t["catch"](0),e.isLoading=!1,console.log("error",t.t0),v["a"].fire({icon:"error",title:"載入資料失敗，請稍後再試"});case 16:case"end":return t.stop()}}),t,null,[[0,11]])})))()},afterAddFollow:function(e){var t=e.userId;t!==this.user.id&&t!==this.currentUser.id&&this.user.id!==this.currentUser.id||(this.user.id===t&&(this.user.followerCount+=1,console.log("跟隨者",this.user.followerCount)),this.currentUser.id!==t&&this.user.id!==t&&(this.user.followingCount+=1,console.log("跟隨中",this.user.followingCount)))},afterDeleteFollow:function(e){var t=e.userId;t!==this.user.id&&t!==this.currentUser.id&&this.user.id!==this.currentUser.id||(this.user.id===t&&(this.user.followerCount-=1,console.log("跟隨者",this.user.followerCount)),this.currentUser.id!==t&&this.user.id!==t&&(this.user.followingCount-=1,console.log("跟隨中",this.user.followingCount)))},afterAddFollowProfile:function(){this.user.followerCount+=1},afterDeleteFollowProfile:function(){this.user.followerCount-=1}},beforeRouteUpdate:function(e,t,s){var r=e.params.id;this.fetchTopUsers(),this.fetchUser({userId:r}),this.fetchTweetsLike({userId:r});var i=this.$router.history.current.name;"user-follower"===i&&r===this.currentUser.id&&(this.MainPage=!1,this.isSetting=!1,this.PersonalInfo=!0,this.ChatRoom=!1),s()}},U=T,x=(s("7743"),Object(g["a"])(U,r,i,!1,null,"2bf88c34",null));t["default"]=x.exports},4973:function(e,t,s){},"60c3":function(e,t,s){"use strict";s("c9f6")},7743:function(e,t,s){"use strict";s("4973")},c9f6:function(e,t,s){}}]);
//# sourceMappingURL=chunk-2b6f1e77.7d3fdf3c.js.map